<div class="page-container">
    <div class="page-header">
        <h1>ü§ñ Smart SR Assignment</h1>
        <p class="page-subtitle">AI-Powered SR Analysis using RAG Pipeline</p>
    </div>

    <!-- Status Banner -->
    <div class="status-banner" id="rag-status-banner">
        <div class="status-indicator" id="rag-status-indicator">
            <span class="status-dot"></span>
            <span class="status-text">Checking RAG System Status...</span>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-value" id="stat-vectorstore">-</div>
            <div class="stat-label">Vectorstore Records</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üîç</div>
            <div class="stat-value" id="stat-processed">-</div>
            <div class="stat-label">SRs Processed</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-value" id="stat-team">-</div>
            <div class="stat-label">Team Members</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon">‚ö°</div>
            <div class="stat-value" id="stat-categories">-</div>
            <div class="stat-label">Categories</div>
        </div>
    </div>

    <!-- Main Tabs -->
    <div class="smart-sr-tabs">
        <button class="smart-sr-tab active" data-tab="analyze">
            üî¨ Analyze SR
        </button>
        <button class="smart-sr-tab" data-tab="semantic-search">
            üîç Semantic Search
        </button>
        <button class="smart-sr-tab" data-tab="batch-upload">
            üì§ Batch Upload
        </button>
        <button class="smart-sr-tab" data-tab="history">
            üìú Analysis History
        </button>
    </div>

    <!-- Tab Content: Analyze SR -->
    <div class="smart-sr-content active" id="tab-analyze">
        <div class="analyze-section">
            <h3>üìù Enter SR Details</h3>
            <form id="analyze-sr-form" class="analyze-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="sr-id-input">SR ID</label>
                        <input type="text" id="sr-id-input" placeholder="e.g., SR-12345" />
                    </div>
                    <div class="form-group">
                        <label for="sr-category-input">Category</label>
                        <select id="sr-category-input">
                            <option value="">Select Category</option>
                            <option value="Billing">Billing</option>
                            <option value="Provisioning">Provisioning</option>
                            <option value="OSS">OSS</option>
                            <option value="CRM">CRM</option>
                            <option value="Order Management">Order Management</option>
                            <option value="Network">Network</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sr-customer-input">Customer ID</label>
                        <input type="text" id="sr-customer-input" placeholder="e.g., CUST001" />
                    </div>
                </div>
                <div class="form-group full-width">
                    <label for="sr-description-input">SR Description *</label>
                    <textarea id="sr-description-input" rows="6" 
                        placeholder="Paste the SR description here..."></textarea>
                </div>
                <div class="form-group full-width">
                    <label for="sr-updates-input">Update Details (Optional)</label>
                    <textarea id="sr-updates-input" rows="4" 
                        placeholder="Any additional update details..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn" id="analyze-btn">
                        üöÄ Analyze with AI
                    </button>
                    <button type="button" class="secondary-btn" id="clear-form-btn">
                        üîÑ Clear
                    </button>
                </div>
            </form>
        </div>

        <!-- Analysis Results -->
        <div class="results-section" id="analysis-results" style="display: none;">
            <h3>üìä Analysis Results</h3>
            <div class="results-grid">
                <div class="result-card">
                    <h4>üéØ Suggested Workaround</h4>
                    <div class="result-content" id="result-workaround">-</div>
                </div>
                <div class="result-card">
                    <h4>‚òï Java Error Detection</h4>
                    <div class="result-content" id="result-java">-</div>
                </div>
                <div class="result-card">
                    <h4>üè∑Ô∏è Categorization</h4>
                    <div class="result-content" id="result-category">-</div>
                </div>
                <div class="result-card">
                    <h4>üë§ Team Assignment</h4>
                    <div class="result-content" id="result-assignment">-</div>
                </div>
                <div class="result-card full-width">
                    <h4>üìù AI Resolution</h4>
                    <div class="result-content" id="result-resolution">-</div>
                </div>
            </div>
            <div class="result-actions">
                <button class="primary-btn" id="copy-results-btn">üìã Copy Results</button>
                <button class="secondary-btn" id="export-results-btn">üì• Export to Excel</button>
            </div>
        </div>
    </div>

    <!-- Tab Content: Semantic Search -->
    <div class="smart-sr-content" id="tab-semantic-search">
        <div class="search-section">
            <h3>üîç Search Historical SRs</h3>
            <p class="section-description">
                Find similar historical SRs using AI-powered semantic search across the vectorstore.
            </p>
            <div class="search-form">
                <div class="form-group">
                    <label for="semantic-query">Search Query</label>
                    <textarea id="semantic-query" rows="3" 
                        placeholder="Describe the issue you want to search for..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="search-limit">Results Limit</label>
                        <select id="search-limit">
                            <option value="5">5 results</option>
                            <option value="10" selected>10 results</option>
                            <option value="20">20 results</option>
                            <option value="50">50 results</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button type="button" class="primary-btn" id="semantic-search-btn">
                            üîç Search
                        </button>
                    </div>
                </div>
            </div>
            <div class="search-results" id="semantic-results">
                <p class="empty-state">Enter a query and click Search to find similar SRs</p>
            </div>
        </div>
    </div>

    <!-- Tab Content: Batch Upload -->
    <div class="smart-sr-content" id="tab-batch-upload">
        <div class="upload-section">
            <h3>üì§ Batch SR Analysis</h3>
            <p class="section-description">
                Upload an Excel file with multiple SRs for batch analysis using the RAG pipeline.
            </p>
            <div class="upload-zone" id="upload-dropzone">
                <div class="upload-icon">üìÅ</div>
                <p>Drag & drop Excel file here or click to browse</p>
                <p class="upload-hint">Supported formats: .xlsx, .xls</p>
                <input type="file" id="batch-file-input" accept=".xlsx,.xls" style="display:none" />
            </div>
            <div class="upload-progress" id="upload-progress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p class="progress-text" id="progress-text">Processing...</p>
            </div>
            <div class="batch-results" id="batch-results" style="display: none;">
                <h4>Batch Analysis Results</h4>
                <div class="batch-stats">
                    <span class="batch-stat">Total: <strong id="batch-total">0</strong></span>
                    <span class="batch-stat success">Success: <strong id="batch-success">0</strong></span>
                    <span class="batch-stat error">Failed: <strong id="batch-failed">0</strong></span>
                </div>
                <button class="primary-btn" id="download-batch-results">üì• Download Results</button>
            </div>
        </div>
    </div>

    <!-- Tab Content: History -->
    <div class="smart-sr-content" id="tab-history">
        <div class="history-section">
            <h3>üìú Analysis History</h3>
            <p class="section-description">
                View recent SR analyses performed using the Smart Assignment system.
            </p>
            <div class="history-filters">
                <input type="date" id="history-date-filter" />
                <select id="history-status-filter">
                    <option value="">All Status</option>
                    <option value="success">Success</option>
                    <option value="failed">Failed</option>
                </select>
                <button class="secondary-btn" id="refresh-history-btn">üîÑ Refresh</button>
            </div>
            <div class="history-table-container">
                <table id="history-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>SR ID</th>
                            <th>Category</th>
                            <th>Status</th>
                            <th>Assigned To</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="history-tbody">
                        <tr>
                            <td colspan="6" class="empty-state">No history available</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="smart-sr-loader" style="display: none;">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <p class="loader-text">Processing with AI...</p>
            <p class="loader-subtext" id="loader-status">This may take 15-30 seconds</p>
        </div>
    </div>
</div>

<style>
/* Smart SR Assignment Styles - Using Orionverse Theme Variables */
.smart-sr-tabs {
    display: flex;
    gap: 0;
    margin: 20px 0;
    border-bottom: 2px solid var(--border-primary);
}

.smart-sr-tab {
    padding: 12px 24px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
    border-bottom: 3px solid transparent;
    transition: all 0.3s ease;
}

.smart-sr-tab:hover {
    color: var(--accent-primary);
    background: rgba(139, 92, 246, 0.1);
}

.smart-sr-tab.active {
    color: var(--accent-primary);
    border-bottom-color: var(--accent-primary);
}

.smart-sr-content {
    display: none;
    padding: 20px 0;
}

.smart-sr-content.active {
    display: block;
}

.status-banner {
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    border-left: 4px solid var(--accent-primary);
    border-radius: 12px;
    padding: 12px 20px;
    margin-bottom: 20px;
}

.status-indicator {
    display: flex;
    align-items: center;
    gap: 10px;
}

.status-text {
    color: var(--text-primary);
}

.status-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #fbbf24;
    animation: pulse 2s infinite;
}

.status-dot.ready {
    background: #10b981;
    animation: none;
}

.status-dot.error {
    background: #ef4444;
    animation: none;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
}

.stat-card {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    border: 1px solid var(--border-primary);
    transition: all 0.3s;
}

.stat-card:hover {
    border-color: var(--accent-primary);
    transform: translateY(-3px);
}

.stat-icon {
    font-size: 32px;
    margin-bottom: 8px;
}

.stat-value {
    font-size: 28px;
    font-weight: 700;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.stat-label {
    font-size: 13px;
    color: var(--text-secondary);
    margin-top: 4px;
}

.analyze-form {
    background: var(--bg-secondary);
    padding: 24px;
    border-radius: 12px;
    border: 1px solid var(--border-primary);
}

.analyze-section h3,
.search-section h3,
.upload-section h3,
.history-section h3,
.results-section h3 {
    color: var(--text-primary);
    margin-bottom: 16px;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.form-group {
    margin-bottom: 16px;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-group label {
    display: block;
    font-weight: 500;
    margin-bottom: 6px;
    color: var(--text-primary);
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px 14px;
    background: var(--bg-primary);
    border: 1px solid var(--border-primary);
    border-radius: 8px;
    font-size: 14px;
    color: var(--text-primary);
    transition: border-color 0.2s;
}

.form-group input::placeholder,
.form-group textarea::placeholder {
    color: var(--text-secondary);
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
}

.form-actions {
    display: flex;
    gap: 12px;
    margin-top: 20px;
}

.results-section {
    margin-top: 30px;
    background: var(--bg-secondary);
    padding: 24px;
    border-radius: 12px;
    border: 1px solid var(--border-primary);
}

.results-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin-top: 16px;
}

.result-card {
    background: var(--bg-primary);
    padding: 16px;
    border-radius: 8px;
    border: 1px solid var(--border-primary);
}

.result-card.full-width {
    grid-column: 1 / -1;
}

.result-card h4 {
    margin: 0 0 12px 0;
    font-size: 14px;
    color: var(--text-secondary);
}

.result-content {
    font-size: 14px;
    color: var(--text-primary);
    line-height: 1.6;
}

.result-actions {
    display: flex;
    gap: 12px;
    margin-top: 20px;
}

.search-results {
    margin-top: 20px;
}

.empty-state {
    text-align: center;
    padding: 40px;
    color: var(--text-secondary);
}

.upload-zone {
    border: 2px dashed var(--border-primary);
    border-radius: 12px;
    padding: 60px 40px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    color: var(--text-secondary);
}

.upload-zone:hover {
    border-color: var(--accent-primary);
    background: rgba(139, 92, 246, 0.1);
}

.upload-icon {
    font-size: 48px;
    margin-bottom: 16px;
}

.upload-hint {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 8px;
}

.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(10, 10, 18, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.loader-content {
    background: var(--bg-secondary);
    padding: 40px;
    border-radius: 16px;
    text-align: center;
    border: 1px solid var(--border-primary);
}

.loader-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid var(--border-primary);
    border-top-color: var(--accent-primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 20px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loader-text {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text-primary);
}

.loader-subtext {
    font-size: 14px;
    color: var(--text-secondary);
}

.section-description {
    color: var(--text-secondary);
    margin-bottom: 20px;
}

.history-filters {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
}

.history-filters input,
.history-filters select {
    padding: 10px 14px;
    background: var(--bg-primary);
    border: 1px solid var(--border-primary);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 14px;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
}

.data-table th,
.data-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--border-primary);
    color: var(--text-primary);
}

.data-table th {
    background: var(--bg-primary);
    font-weight: 600;
    color: var(--text-secondary);
}

.batch-stats {
    display: flex;
    gap: 20px;
    margin: 16px 0;
}

.batch-stat {
    padding: 8px 16px;
    border-radius: 8px;
    background: var(--bg-primary);
    color: var(--text-primary);
}

.batch-stat.success {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.batch-stat.error {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
}

/* Search Section Styles */
.search-form {
    background: var(--bg-secondary);
    padding: 24px;
    border-radius: 12px;
    border: 1px solid var(--border-primary);
}

/* Upload Section Styles */
.upload-section {
    background: var(--bg-secondary);
    padding: 24px;
    border-radius: 12px;
    border: 1px solid var(--border-primary);
}

/* History Section Styles */
.history-section {
    background: var(--bg-secondary);
    padding: 24px;
    border-radius: 12px;
    border: 1px solid var(--border-primary);
}

.history-table-container {
    overflow-x: auto;
}

/* Semantic Search Result Items */
.search-result-item {
    background: var(--bg-primary);
    border: 1px solid var(--border-primary);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 12px;
    transition: all 0.2s;
}

.search-result-item:hover {
    border-color: var(--accent-primary);
}

.search-result-item .sr-id {
    color: var(--accent-primary);
    font-weight: 600;
    font-size: 15px;
}

.search-result-item .similarity-score {
    background: var(--accent-gradient);
    color: white;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
}

.search-result-item .sr-description {
    color: var(--text-primary);
    margin-top: 10px;
    font-size: 14px;
    line-height: 1.5;
}

.search-result-item .sr-workaround {
    color: var(--text-secondary);
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid var(--border-primary);
    font-size: 13px;
}
</style>

