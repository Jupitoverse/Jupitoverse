<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroid & Comet Explorer | Interactive Solar System Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1b3d 50%, #0a0e27 100%);
            color: #ffffff;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="white" opacity="0.5"/><circle cx="80" cy="30" r="0.5" fill="white" opacity="0.3"/><circle cx="50" cy="70" r="0.8" fill="white" opacity="0.4"/><circle cx="90" cy="80" r="0.6" fill="white" opacity="0.5"/></svg>');
            opacity: 0.3;
            animation: twinkle 8s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        h1 {
            font-size: 3.5em;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(126, 34, 206, 0.8);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.3em;
            color: #cbd5e1;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .stat {
            text-align: center;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #fbbf24;
        }

        .stat-label {
            font-size: 0.9em;
            color: #cbd5e1;
            margin-top: 5px;
        }

        .simulation-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            padding: 20px;
            margin: 40px 0;
            border: 2px solid rgba(126, 34, 206, 0.3);
            box-shadow: 0 0 50px rgba(126, 34, 206, 0.2);
        }

        #canvas3d {
            width: 100%;
            height: 600px;
            background: radial-gradient(circle at center, #1a1b3d 0%, #0a0e27 100%);
            border-radius: 15px;
            position: relative;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .info-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .info-card {
            background: linear-gradient(135deg, rgba(30, 60, 114, 0.8) 0%, rgba(42, 82, 152, 0.6) 100%);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(126, 34, 206, 0.3);
            transition: all 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(126, 34, 206, 0.4);
        }

        .info-card h3 {
            color: #fbbf24;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-card p {
            color: #cbd5e1;
            line-height: 1.8;
        }

        .asteroid-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .asteroid-card {
            background: linear-gradient(135deg, rgba(126, 34, 206, 0.2) 0%, rgba(30, 60, 114, 0.3) 100%);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(126, 34, 206, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .asteroid-card:hover {
            transform: scale(1.05);
            border-color: #fbbf24;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3);
        }

        .asteroid-card h4 {
            color: #fbbf24;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .asteroid-properties {
            color: #cbd5e1;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin: 5px 5px 5px 0;
        }

        .badge-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .badge-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .badge-info {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .badge-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .legend {
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 15px;
            margin: 40px 0;
        }

        .legend h3 {
            color: #fbbf24;
            margin-bottom: 15px;
        }

        .legend-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.5);
            margin-top: 60px;
            color: #94a3b8;
        }

        footer a {
            color: #fbbf24;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .subtitle {
                font-size: 1em;
            }

            .stats {
                gap: 20px;
            }

            .stat {
                padding: 10px 20px;
            }

            .stat-number {
                font-size: 1.8em;
            }

            #canvas3d {
                height: 400px;
            }
        }

        /* Loading animation */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: #fbbf24;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Info overlay */
        .info-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            max-width: 300px;
            display: none;
        }

        .info-overlay.active {
            display: block;
        }

        .info-overlay h4 {
            color: #fbbf24;
            margin-bottom: 10px;
        }

        .info-overlay p {
            color: #cbd5e1;
            font-size: 0.9em;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>üåå Asteroid & Comet Explorer</h1>
        <p class="subtitle">Interactive Solar System Simulation with Real Data from NASA/JPL</p>
        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="asteroidCount">950,000+</div>
                <div class="stat-label">Known Asteroids</div>
            </div>
            <div class="stat">
                <div class="stat-number">3,743</div>
                <div class="stat-label">Comets</div>
            </div>
            <div class="stat">
                <div class="stat-number">32,000+</div>
                <div class="stat-label">Near-Earth Objects</div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="simulation-container">
            <div id="canvas3d">
                <div class="loading">
                    <div class="spinner"></div>
                    <p style="margin-top: 15px; color: #cbd5e1;">Initializing Solar System...</p>
                </div>
                <div class="info-overlay" id="objectInfo">
                    <h4 id="objectName">Select an object</h4>
                    <p id="objectDetails"></p>
                </div>
            </div>
            <div class="controls">
                <button class="control-btn" onclick="toggleAnimation()">‚èØÔ∏è Play/Pause</button>
                <button class="control-btn" onclick="speedUp()">‚è© Speed Up</button>
                <button class="control-btn" onclick="slowDown()">‚è™ Slow Down</button>
                <button class="control-btn" onclick="resetView()">üîÑ Reset View</button>
                <button class="control-btn" onclick="toggleOrbits()">üëÅÔ∏è Toggle Orbits</button>
            </div>
        </div>

        <div class="legend">
            <h3>üé® Object Legend</h3>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #ffd700, #ffa500);"></div>
                    <span>Sun</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #4169e1, #1e3a8a);"></div>
                    <span>Earth</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #dc2626, #991b1b);"></div>
                    <span>Mars</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #a78bfa, #7c3aed);"></div>
                    <span>Jupiter</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #ffffff, #94a3b8);"></div>
                    <span>Asteroids</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: radial-gradient(circle, #60a5fa, #3b82f6);"></div>
                    <span>Comets</span>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <div class="info-card">
                <h3>‚òÑÔ∏è What are Asteroids?</h3>
                <p>Asteroids are rocky, airless remnants left over from the early formation of our solar system about 4.6 billion years ago. Most asteroids orbit the Sun in the main asteroid belt between Mars and Jupiter.</p>
            </div>
            <div class="info-card">
                <h3>üå† What are Comets?</h3>
                <p>Comets are cosmic snowballs of frozen gases, rock, and dust. When heated by the Sun, they develop a glowing coma and spectacular tails that can stretch millions of miles through space.</p>
            </div>
            <div class="info-card">
                <h3>‚ö†Ô∏è Near-Earth Objects (NEOs)</h3>
                <p>NEOs are asteroids and comets with orbits that bring them within 1.3 AU of the Sun. Scientists track over 32,000 NEOs to ensure planetary defense and study our cosmic neighborhood.</p>
            </div>
            <div class="info-card">
                <h3>üéØ Potentially Hazardous</h3>
                <p>PHAs are objects larger than about 140 meters with orbits that can bring them within 7.5 million km of Earth's orbit. Currently, there are over 2,300 known PHAs being monitored.</p>
            </div>
        </div>

        <h2 style="text-align: center; color: #fbbf24; margin: 40px 0 20px 0;">üîç Featured Asteroids & Comets</h2>
        
        <div class="asteroid-list" id="asteroidList">
            <!-- Dynamically populated -->
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Asteroid & Comet Explorer | Data sourced from NASA/JPL Small Body Database</p>
        <p>Part of the <a href="#">Jupitoverse</a> interactive science collection</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Featured asteroids and comets data
        const celestialObjects = [
            {
                name: "1 Ceres",
                type: "asteroid",
                diameter: 939,
                period: 4.60,
                distance: 2.77,
                description: "Largest object in the asteroid belt and a dwarf planet",
                badges: ["Dwarf Planet", "Main Belt"],
                color: 0xcccccc,
                orbit: { a: 2.77, e: 0.08, i: 10.6 }
            },
            {
                name: "4 Vesta",
                type: "asteroid",
                diameter: 525,
                period: 3.63,
                distance: 2.36,
                description: "Second-largest asteroid, visited by NASA's Dawn mission",
                badges: ["Main Belt", "Visited"],
                color: 0xe0e0e0,
                orbit: { a: 2.36, e: 0.09, i: 7.1 }
            },
            {
                name: "433 Eros",
                type: "asteroid",
                diameter: 16.8,
                period: 1.76,
                distance: 1.46,
                description: "Near-Earth asteroid, first to be orbited by a spacecraft",
                badges: ["Near-Earth", "Visited"],
                color: 0xff9999,
                orbit: { a: 1.46, e: 0.22, i: 10.8 }
            },
            {
                name: "99942 Apophis",
                type: "asteroid",
                diameter: 0.370,
                period: 0.89,
                distance: 0.92,
                description: "Famous near-Earth asteroid, will pass close to Earth in 2029",
                badges: ["Near-Earth", "PHA"],
                color: 0xff6666,
                orbit: { a: 0.92, e: 0.19, i: 3.3 }
            },
            {
                name: "101955 Bennu",
                type: "asteroid",
                diameter: 0.492,
                period: 1.20,
                distance: 1.13,
                description: "Target of NASA's OSIRIS-REx sample return mission",
                badges: ["Near-Earth", "Sample Return"],
                color: 0xff7777,
                orbit: { a: 1.13, e: 0.20, i: 6.0 }
            },
            {
                name: "1P/Halley",
                type: "comet",
                diameter: 11,
                period: 75.3,
                distance: 17.8,
                description: "Most famous comet, visible from Earth every 75-76 years",
                badges: ["Periodic", "Famous"],
                color: 0x60a5fa,
                orbit: { a: 17.8, e: 0.97, i: 162.3 }
            },
            {
                name: "67P Churyumov-Gerasimenko",
                type: "comet",
                diameter: 4.1,
                period: 6.45,
                distance: 3.46,
                description: "Target of ESA's Rosetta mission, first comet landing site",
                badges: ["Periodic", "Visited"],
                color: 0x3b82f6,
                orbit: { a: 3.46, e: 0.64, i: 7.0 }
            },
            {
                name: "C/2020 F3 NEOWISE",
                type: "comet",
                diameter: 5,
                period: 6766,
                distance: 295,
                description: "Bright comet visible to naked eye in July 2020",
                badges: ["Long Period", "Recent"],
                color: 0x7dd3fc,
                orbit: { a: 295, e: 0.999, i: 128.9 }
            },
            {
                name: "16 Psyche",
                type: "asteroid",
                diameter: 226,
                period: 5.0,
                distance: 2.92,
                description: "Metallic asteroid, target of NASA's Psyche mission",
                badges: ["Main Belt", "Metal-Rich"],
                color: 0xb8b8b8,
                orbit: { a: 2.92, e: 0.13, i: 3.1 }
            },
            {
                name: "243 Ida",
                type: "asteroid",
                diameter: 31.4,
                period: 4.84,
                distance: 2.86,
                description: "First asteroid found to have a moon (Dactyl)",
                badges: ["Main Belt", "Has Moon"],
                color: 0xdddddd,
                orbit: { a: 2.86, e: 0.04, i: 1.1 }
            },
            {
                name: "2004 MN4 (Apophis)",
                type: "asteroid",
                diameter: 0.370,
                period: 0.89,
                distance: 0.92,
                description: "Will pass within 31,000 km of Earth on April 13, 2029",
                badges: ["Near-Earth", "Close Approach 2029"],
                color: 0xff4444,
                orbit: { a: 0.92, e: 0.19, i: 3.3 }
            },
            {
                name: "162173 Ryugu",
                type: "asteroid",
                diameter: 0.896,
                period: 1.30,
                distance: 1.19,
                description: "Target of JAXA's Hayabusa2 sample return mission",
                badges: ["Near-Earth", "Sample Return"],
                color: 0xff8888,
                orbit: { a: 1.19, e: 0.19, i: 5.9 }
            }
        ];

        // Three.js scene setup
        let scene, camera, renderer, controls;
        let sun, earth, mars, jupiter;
        let asteroids = [];
        let comets = [];
        let isAnimating = true;
        let animationSpeed = 1;
        let showOrbits = true;
        let orbitLines = [];

        function init3D() {
            const canvas = document.getElementById('canvas3d');
            const loading = canvas.querySelector('.loading');

            // Scene
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.00025);

            // Camera
            camera = new THREE.PerspectiveCamera(
                60,
                canvas.clientWidth / canvas.clientHeight,
                0.1,
                10000
            );
            camera.position.set(0, 50, 150);
            camera.lookAt(0, 0, 0);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setClearColor(0x0a0e27, 1);
            canvas.innerHTML = '';
            canvas.appendChild(renderer.domElement);
            canvas.appendChild(document.getElementById('objectInfo'));

            // Lights
            const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0xffffff, 2, 1000);
            pointLight.position.set(0, 0, 0);
            scene.add(pointLight);

            // Add stars
            addStars();

            // Add Sun
            const sunGeometry = new THREE.SphereGeometry(8, 32, 32);
            const sunMaterial = new THREE.MeshBasicMaterial({
                color: 0xffd700,
                emissive: 0xffa500,
                emissiveIntensity: 1
            });
            sun = new THREE.Mesh(sunGeometry, sunMaterial);
            scene.add(sun);

            // Add Sun glow
            const glowGeometry = new THREE.SphereGeometry(10, 32, 32);
            const glowMaterial = new THREE.ShaderMaterial({
                uniforms: {},
                vertexShader: `
                    varying vec3 vNormal;
                    void main() {
                        vNormal = normalize(normalMatrix * normal);
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec3 vNormal;
                    void main() {
                        float intensity = pow(0.7 - dot(vNormal, vec3(0.0, 0.0, 1.0)), 2.0);
                        gl_FragColor = vec4(1.0, 0.8, 0.0, 1.0) * intensity;
                    }
                `,
                side: THREE.BackSide,
                blending: THREE.AdditiveBlending,
                transparent: true
            });
            const glow = new THREE.Mesh(glowGeometry, glowMaterial);
            sun.add(glow);

            // Add planets
            addPlanet('earth', 30, 0x4169e1, 3);
            addPlanet('mars', 45, 0xdc2626, 2);
            addPlanet('jupiter', 120, 0xa78bfa, 7);

            // Add asteroids
            celestialObjects.forEach((obj, index) => {
                if (obj.type === 'asteroid') {
                    addAsteroidOrComet(obj, index);
                } else if (obj.type === 'comet') {
                    addAsteroidOrComet(obj, index);
                }
            });

            // Add orbit lines
            drawOrbits();

            // Mouse controls
            let isDragging = false;
            let previousMousePosition = { x: 0, y: 0 };

            canvas.addEventListener('mousedown', (e) => {
                isDragging = true;
                previousMousePosition = { x: e.clientX, y: e.clientY };
            });

            canvas.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const deltaX = e.clientX - previousMousePosition.x;
                    const deltaY = e.clientY - previousMousePosition.y;
                    camera.position.x += deltaX * 0.1;
                    camera.position.y -= deltaY * 0.1;
                    camera.lookAt(0, 0, 0);
                    previousMousePosition = { x: e.clientX, y: e.clientY };
                }
            });

            canvas.addEventListener('mouseup', () => {
                isDragging = false;
            });

            canvas.addEventListener('wheel', (e) => {
                e.preventDefault();
                camera.position.z += e.deltaY * 0.1;
                camera.position.z = Math.max(50, Math.min(300, camera.position.z));
            });

            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            });

            // Start animation
            animate();
        }

        function addStars() {
            const starGeometry = new THREE.BufferGeometry();
            const starMaterial = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 0.7,
                transparent: true,
                opacity: 0.8
            });

            const starVertices = [];
            for (let i = 0; i < 10000; i++) {
                const x = (Math.random() - 0.5) * 2000;
                const y = (Math.random() - 0.5) * 2000;
                const z = (Math.random() - 0.5) * 2000;
                starVertices.push(x, y, z);
            }

            starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            const stars = new THREE.Points(starGeometry, starMaterial);
            scene.add(stars);
        }

        function addPlanet(name, distance, color, size) {
            const geometry = new THREE.SphereGeometry(size, 32, 32);
            const material = new THREE.MeshPhongMaterial({ color: color });
            const planet = new THREE.Mesh(geometry, material);
            planet.userData = { distance: distance, angle: Math.random() * Math.PI * 2, speed: 0.001 };
            planet.name = name;
            scene.add(planet);

            if (name === 'earth') earth = planet;
            if (name === 'mars') mars = planet;
            if (name === 'jupiter') jupiter = planet;
        }

        function addAsteroidOrComet(obj, index) {
            const size = Math.max(0.5, Math.log(obj.diameter + 1) * 0.3);
            const geometry = obj.type === 'comet' 
                ? new THREE.ConeGeometry(size, size * 2, 8)
                : new THREE.SphereGeometry(size, 16, 16);
            
            const material = new THREE.MeshPhongMaterial({
                color: obj.color,
                emissive: obj.type === 'comet' ? 0x3b82f6 : 0x000000,
                emissiveIntensity: obj.type === 'comet' ? 0.3 : 0
            });
            
            const mesh = new THREE.Mesh(geometry, material);
            
            // Calculate orbital position
            const a = obj.orbit.a * 20; // Scale factor
            const e = obj.orbit.e;
            const angle = (index / celestialObjects.length) * Math.PI * 2;
            
            mesh.userData = {
                name: obj.name,
                distance: a,
                eccentricity: e,
                angle: angle,
                speed: 0.0005 / obj.period,
                type: obj.type,
                info: obj.description
            };
            
            scene.add(mesh);
            
            if (obj.type === 'comet') {
                // Add comet tail
                const tailGeometry = new THREE.BufferGeometry();
                const tailVertices = [];
                for (let i = 0; i < 50; i++) {
                    tailVertices.push(0, 0, -i * 0.5);
                }
                tailGeometry.setAttribute('position', new THREE.Float32BufferAttribute(tailVertices, 3));
                const tailMaterial = new THREE.LineBasicMaterial({
                    color: 0x60a5fa,
                    transparent: true,
                    opacity: 0.6
                });
                const tail = new THREE.Line(tailGeometry, tailMaterial);
                mesh.add(tail);
                comets.push(mesh);
            } else {
                asteroids.push(mesh);
            }
        }

        function drawOrbits() {
            celestialObjects.forEach(obj => {
                const points = [];
                const a = obj.orbit.a * 20;
                const e = obj.orbit.e;
                const segments = 100;
                
                for (let i = 0; i <= segments; i++) {
                    const angle = (i / segments) * Math.PI * 2;
                    const r = a * (1 - e * e) / (1 + e * Math.cos(angle));
                    const x = r * Math.cos(angle);
                    const z = r * Math.sin(angle);
                    points.push(new THREE.Vector3(x, 0, z));
                }
                
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const material = new THREE.LineBasicMaterial({
                    color: obj.color,
                    transparent: true,
                    opacity: 0.2
                });
                const orbit = new THREE.Line(geometry, material);
                scene.add(orbit);
                orbitLines.push(orbit);
            });
        }

        function animate() {
            requestAnimationFrame(animate);

            if (isAnimating) {
                // Rotate sun
                sun.rotation.y += 0.001;

                // Update planets
                [earth, mars, jupiter].forEach(planet => {
                    if (planet) {
                        planet.userData.angle += planet.userData.speed * animationSpeed;
                        planet.position.x = Math.cos(planet.userData.angle) * planet.userData.distance;
                        planet.position.z = Math.sin(planet.userData.angle) * planet.userData.distance;
                        planet.rotation.y += 0.005;
                    }
                });

                // Update asteroids and comets
                [...asteroids, ...comets].forEach(obj => {
                    obj.userData.angle += obj.userData.speed * animationSpeed;
                    const r = obj.userData.distance * (1 - obj.userData.eccentricity * obj.userData.eccentricity) / 
                              (1 + obj.userData.eccentricity * Math.cos(obj.userData.angle));
                    obj.position.x = r * Math.cos(obj.userData.angle);
                    obj.position.z = r * Math.sin(obj.userData.angle);
                    obj.rotation.y += 0.01;
                });
            }

            renderer.render(scene, camera);
        }

        function toggleAnimation() {
            isAnimating = !isAnimating;
        }

        function speedUp() {
            animationSpeed = Math.min(animationSpeed * 2, 32);
        }

        function slowDown() {
            animationSpeed = Math.max(animationSpeed / 2, 0.125);
        }

        function resetView() {
            camera.position.set(0, 50, 150);
            camera.lookAt(0, 0, 0);
            animationSpeed = 1;
        }

        function toggleOrbits() {
            showOrbits = !showOrbits;
            orbitLines.forEach(orbit => {
                orbit.visible = showOrbits;
            });
        }

        // Populate asteroid cards
        function populateAsteroidCards() {
            const list = document.getElementById('asteroidList');
            
            celestialObjects.forEach(obj => {
                const card = document.createElement('div');
                card.className = 'asteroid-card';
                
                const badges = obj.badges.map(badge => {
                    let className = 'badge badge-info';
                    if (badge.includes('PHA') || badge.includes('Hazardous')) className = 'badge badge-danger';
                    else if (badge.includes('Near-Earth') || badge.includes('Close')) className = 'badge badge-warning';
                    else if (badge.includes('Visited') || badge.includes('Sample')) className = 'badge badge-success';
                    return `<span class="${className}">${badge}</span>`;
                }).join('');
                
                card.innerHTML = `
                    <h4>${obj.type === 'comet' ? '‚òÑÔ∏è' : '‚òÑÔ∏è'} ${obj.name}</h4>
                    <div>${badges}</div>
                    <div class="asteroid-properties">
                        <p><strong>Diameter:</strong> ${obj.diameter} km</p>
                        <p><strong>Orbital Period:</strong> ${obj.period.toFixed(2)} years</p>
                        <p><strong>Distance from Sun:</strong> ${obj.distance.toFixed(2)} AU</p>
                        <p style="margin-top: 10px;">${obj.description}</p>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    showObjectInfo(obj);
                });
                
                list.appendChild(card);
            });
        }

        function showObjectInfo(obj) {
            const infoOverlay = document.getElementById('objectInfo');
            const objectName = document.getElementById('objectName');
            const objectDetails = document.getElementById('objectDetails');
            
            objectName.textContent = obj.name;
            objectDetails.innerHTML = `
                <p><strong>Type:</strong> ${obj.type.charAt(0).toUpperCase() + obj.type.slice(1)}</p>
                <p><strong>Diameter:</strong> ${obj.diameter} km</p>
                <p><strong>Period:</strong> ${obj.period.toFixed(2)} years</p>
                <p style="margin-top: 10px;">${obj.description}</p>
            `;
            
            infoOverlay.classList.add('active');
            
            setTimeout(() => {
                infoOverlay.classList.remove('active');
            }, 5000);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            init3D();
            populateAsteroidCards();
        });
    </script>
</body>
</html>

